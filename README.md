# NN-based heightmap generator

## Содержание

- [Вступление](#introduction)
- [Входные и выходные данные](#in/out_data)
- [Пайплайн](#pipeline)
- [Модель](#model)
- [Результаты](#results)

## Вступление
С каждым днем требования к качеству создаваемых ландшафтов в кинематографической и игровой промышленностях становятся все больше, а наиболее популярные в
использовании методы процедурной генерации являются строго настроенными и слаборасширяемыми. Следовательно, такие алгоритмы нуждаются в частой доработке, а сами 
продукты их работы, по мере увеличения размеров, требуют все больше человеческого вмешательства. Таким образом, повышение качества, разнообразия и размера модели 
ландшафта влечет к большим затратам.   
Решением данной проблемы должен стать новый инструмент, способный к расширению и слабо привязанный к типу ландшафта. 
Целью данной работы является исследование применимости нейронных сетей для генерации реалистичных ландшафтных карт.

## Входные/Выходные данные
На вход пайплайну подается карта высот некоторой поверхности с большой размерностью. 
В моем случае эксперименты проводились над картой высот Земли. Её разрешешение: 21600х10800.   
На практике может быть подана любая карта. 
Были проведены поиски карты высот Луны, но найденные картинки не соответствовали требованиям: либо на них были надписи, либо они были слишком маленького разрешения.
    
Выходными данными являются карты высот, построенные нейросетью.
   
## Пайплайн   
Пайплайн состоит из нескольких этапов:   
1. Подготовка датасета   
   1. Разбиение исходной картинки на квадраты 128х128 пикселей.   
       Были варианты разбиения на квадраты со сторонами 64 и 256 пикселей, но они показали результаты хуже.      
   2. Отсеивание неподходящих данных   
     Условия отсеивания квадратов:      
       - Малая средняя интенсивность   
       - Неравномерность распределения HOG   
       - Близость к полюсам    
2. Обучение нейросети   
   Построение и обучение происходило посредством библиотеки Keras в Python    
3. Получение результатов    
   В процессе обучения каждые N эпох генерировались карты высот   
4. Визуализация результатов   
   Построение трехмерной модели в Unity   
  
  Для ускорения процесса чаще всего ограничивались этапами 2 и 3.    

## Модель   
Из-за малого кол-ва данных (12000 картинок) и специфики задачи было решено использовать архитектуру GAN, которая представляет из себя комбинацию двух нейронок (генератор и дискриминатор).   
Задача генератора - научиться генерировать картинки, схожие с обучающими.   
Задача дискриминатора - научиться отличать сгенерированные картинки от исходных.   
Были проведены эксперименты с двумя видами моделей: U-net и Sgan.   
Вторая показала себя лучше.   
